name: happy-life-bank-test
services:
  happy-life-bank-test:
    hostname: happy-life-bank-test
    image: rafiki-backend
    pull_policy: never
    restart: always
    privileged: true
    ports:
      - "4000:80"
      - "4001:3001"
    networks:
      - rafiki-test
    environment:
      NODE_ENV: development
      LOG_LEVEL: debug
      ADMIN_PORT: 3001
      CONNECTOR_PORT: 3002
      OPEN_PAYMENTS_PORT: 80
      DATABASE_URL: postgresql://happy_life_bank_test_backend:happy_life_bank_test_backend@shared-database/happy_life_bank_test_backend
      USE_TIGERBEETLE: ${USE_TIGERBEETLE-false}
      TIGERBEETLE_CLUSTER_ID: ${TIGERBEETLE_CLUSTER_ID-0}
      TIGERBEETLE_REPLICA_ADDRESSES: ${TIGERBEETLE_REPLICA_ADDRESSES-''}
      AUTH_SERVER_GRANT_URL: ${HAPPY_LIFE_BANK_TEST_AUTH_SERVER_DOMAIN:-http://happy-life-bank-test-auth:3006}
      AUTH_SERVER_INTROSPECTION_URL: http://happy-life-bank-test-auth:3007
      ILP_ADDRESS: test.happy-life-bank-test
      STREAM_SECRET: BjPXtnd00G2mRQwP/8ZpwyZASOch5sUXT5o0iR5b5wU=
      WEBHOOK_URL: http://happy-life-bank-test/webhooks
      OPEN_PAYMENTS_URL: ${HAPPY_LIFE_BANK_TEST_OPEN_PAYMENTS_URL:-http://happy-life-bank-test}
      EXCHANGE_RATES_URL: http://happy-life-bank-test/rates
      REDIS_URL: redis://shared-redis:6379/1
      WALLET_ADDRESS_URL: ${HAPPY_LIFE_BANK_TEST_WALLET_ADDRESS_URL:-https://happy-life-bank-test/.well-known/pay}
    depends_on:
      - cloud-nine-wallet-test-backend
  happy-life-auth:
    hostname: happy-life-bank-test-auth
    image: rafiki-auth
    pull_policy: never
    restart: always
    networks:
      - rafiki-test
    ports:
      - '4003:3003'
      - '4006:3006'
    environment:
      NODE_ENV: development
      AUTH_DATABASE_URL: postgresql://happy_life_bank_test_auth:happy_life_bank_test_auth@shared-database/happy_life_bank_test_auth
      AUTH_SERVER_DOMAIN: ${HAPPY_LIFE_BANK_TEST_AUTH_SERVER_DOMAIN:-http://localhost:4006}
    depends_on:
      - cloud-nine-wallet-test-auth